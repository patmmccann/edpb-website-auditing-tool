<mat-toolbar>
    <mat-toolbar-row class="navigation-header">
        <li class="breadcrumb-item">
            <a>
                <strong>
                    <ng-container *ngIf="type_entries === 'edit' || type_entries === 'new'">
                        Analyses
                    </ng-container>
                    <ng-container *ngIf="type_entries === 'knowledgeBase'">
                        Knowledge base
                    </ng-container>
                    <ng-container *ngIf="type_entries === 'template'">
                        Template
                    </ng-container>
                </strong>
            </a>
        </li>
        <li class="breadcrumb-item">
            <ng-container [ngSwitch]="type_entries">
                <ng-container *ngSwitchCase="'edit'">
                    List
                </ng-container>
                <ng-container *ngSwitchCase="'report'">
                    Report
                </ng-container>
            </ng-container>
        </li>
        <!--
        <span class="header-spacer"></span>
        <strong>
            EN
        </strong>
        <mat-icon aria-hidden="false" aria-label="Example languageicon">language</mat-icon> -->
    </mat-toolbar-row>
</mat-toolbar>

<mat-toolbar *ngIf="type_entries=='knowledgeBase'">
    <div style="margin-left: 30px;">
        <button (click)="openNewKnowledgeDialog()" mat-raised-button color="blue"> <i class="fas fa-plus"></i> {{ 'entries.database.new_database' | translate }}</button>
        <button (click)="import()" mat-raised-button color="blue"><i class="fas fa-file-import"></i> Import </button>
        <button (click)="export_all()" mat-raised-button color="blue"><i class="fas fa-file-export"></i> Export all
        </button>
        <button mat-raised-button color="blue"><mat-icon>search</mat-icon> Search </button>
    </div>
</mat-toolbar>

<mat-toolbar *ngIf="type_entries=='template'">
    <div style="margin-left: 30px;">
        <button (click)="openNewTemplateDialog()" mat-raised-button color="blue"> <i class="fas fa-plus"></i> New
            template</button>
    </div>
</mat-toolbar>

<div class="charts-wrapper">

    <div class="main_panel">
        <ng-container [ngSwitch]="type_entries" *ngIf="!loading; else loadingEntries">
            <ng-container *ngSwitchCase="'edit'">
                <div class="surveytitle">
                    <div style="text-align: center;"><span style="font-size: 14pt;"><strong>List of analysis to be
                                evaluated.</strong></span></div>
                </div>
                <button (click)="import()" mat-raised-button color="blue"><i class="fas fa-file-import"></i>  {{ "entries.list.import" | translate }}</button>
                <br>
                <app-analysis-line *ngFor="
                let analysis of entries | filterForUser: searchText | filterForEval:not_evaluate:compliant:not_compliant:tbd | async;
                let i = index
              " (changed)="updateEntrie($event)" (deleted)="refreshContent()" [analysis]="analysis">
                </app-analysis-line>
            </ng-container>
            <ng-container *ngSwitchCase="'knowledgeBase'">
                <div class="surveytitle">
                    <div style="text-align: center;"><span style="font-size: 14pt;"><strong>List of known trackers with
                                their purposes</strong></span></div>
                </div><br>
                <app-knowledgebase-table [entries]="entries" (changed)="updateEntrie($event)"
                    (duplicated)="refreshContent()" (deleted)="refreshContent()">

                </app-knowledgebase-table>

            </ng-container>
            <ng-container *ngSwitchCase="'template'">
                <div class="surveytitle">
                    <div style="text-align: center;"><span style="font-size: 14pt;"><strong>Templates can be used to
                                format report of analysis in HTML or PDF format.</strong><br><i>Refer to the section
                                templating in help for more information about the template format</i></span>
                    </div>
                </div><br>

                <app-template-table [entries]="entries" (changed)="updateEntrie($event)" (duplicated)="refreshContent()"
                    (deleted)="refreshContent()">

                </app-template-table>

            </ng-container>
        </ng-container>
        <ng-template #loadingEntries>
            <tbody>
                <div class="entries-loading entries-loading-line">
                    <app-loading-overlay [visibility]="true" [childMode]="true"></app-loading-overlay>
                </div>
            </tbody>
        </ng-template>
    </div>
    <div *ngIf="type_entries =='edit'" class="right_panel">
        <mat-card class="sticky-card">
            <mat-card-title>
                <h2>Filters</h2>
            </mat-card-title>
            <mat-card-content>
                <mat-form-field appearance="fill">
                    <mat-label>Search by name</mat-label>
                    <input matInput [(ngModel)]="searchText" />
                    <mat-icon *ngIf="!searchText" matSuffix>search</mat-icon>
                    <mat-icon *ngIf="searchText && searchText.length>0" (click)="onCleanSearch()" matSuffix>close
                    </mat-icon>
                </mat-form-field>
                <mat-list>
                    <mat-divider></mat-divider>
                    <div mat-subheader>Status</div>
                    <mat-list-item>
                        <mat-checkbox [(ngModel)]="not_evaluate" [color]="'primary'">
                            Not evaluate
                        </mat-checkbox>
                    </mat-list-item>
                    <mat-list-item>
                        <mat-checkbox [(ngModel)]="compliant" style="color: green;" [color]="'primary'">
                            Compliant
                        </mat-checkbox>
                    </mat-list-item>
                    <mat-list-item>
                        <mat-checkbox [(ngModel)]="not_compliant" style="color: red;" [color]="'primary'">
                            Not compliant
                        </mat-checkbox>
                    </mat-list-item>
                    <mat-list-item>
                        <mat-checkbox [(ngModel)]="tbd" style="color:#004494;" [color]="'primary'">
                            To be defined
                        </mat-checkbox>
                    </mat-list-item>
                </mat-list>
            </mat-card-content>
        </mat-card>
    </div>
</div>

<!-- Import/export functions -->
<div class="hide">
    <form enctype="multipart/form-data" [formGroup]="importForm">
        <input type="file" formControlName="import_file" id="import_file" (change)="import($event)" class="hide" />
    </form>
    <a href="" id="base-exportBlock"></a>
</div>